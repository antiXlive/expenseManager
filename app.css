/* ============================================================
   0. ROOT VARIABLES & GLOBAL RESET
   ============================================================ */

:root {
  --bg: #050814;
  --bg2: #0b1020;
  --bg3: #111827;
  --card: #151b30;
  --b-sub: rgba(148,163,184,.35);

  --acc: #3b82f6;
  --acc2: #60a5fa;
  --danger: #f97373;

  --t-main: #f9fafb;
  --t-muted: #9ca3af;
  --t-soft: #6b7280;

  --r-lg: 18px;
  --r-md: 12px;

  --nav-h: 64px;
  --safe-b: env(safe-area-inset-bottom,0);
}

* {
  margin:0;
  padding:0;
  box-sizing:border-box;
  -webkit-tap-highlight-color:transparent;
}

body {
  font-family:-apple-system,system-ui,"SF Pro Text","Segoe UI",sans-serif;
  background:radial-gradient(circle at top,#0f172a,#020617 40%,#000);
  color:var(--t-main);
  min-height:100vh;
  display:flex;
  flex-direction:column;
  overflow:hidden;
}

.app {
  height:100vh;
  display:flex;
  flex-direction:column;
  padding:
    env(safe-area-inset-top)
    env(safe-area-inset-right)
    calc(var(--nav-h) + var(--safe-b))
    env(safe-area-inset-left);
}

.hidden { display:none!important; }

/* ============================================================
   1. GLOBAL ELEMENT STYLES & UTILITIES
   ============================================================ */

label {
  color:var(--t-soft);
}

.pos   { color:#4ade80; }
.neg   { color:#f97373; }
.small { font-size:.72rem; padding:4px 8px; }

input[type=file] {
  font-size:.7rem;
  color:var(--t-soft);
}

/* ============================================================
   2. BUTTONS (COMPONENT)
   ============================================================ */

.btn {
  border:none;
  border-radius:999px;
  font-size:.78rem;
  padding:7px 14px;
  display:inline-flex;
  align-items:center;
  gap:6px;
  cursor:pointer;
  white-space:nowrap;
}

.btn-acc {
  background:var(--acc);
  color:#fff;
  box-shadow:0 12px 24px rgba(37,99,235,.7);
}

.btn-ghost {
  background:rgba(15,23,42,.95);
  color:var(--t-muted);
  border:1px solid rgba(75,85,99,.9);
}

.btn-danger {
  background:rgba(127,29,29,.95);
  color:#fee2e2;
}

/* Backup banner small buttons */
.btn-banner {
  border:none;
  border-radius:999px;
  padding:4px 10px;
  font-size:.72rem;
  background:rgba(248,113,113,.9);
  color:#111827;
  cursor:pointer;
}
.btn-banner-close {
  border:none;
  background:transparent;
  color:#fecaca;
  font-size:.9rem;
  cursor:pointer;
}

/* ============================================================
   3. HEADER (COMPONENT)
   ============================================================ */

.app-header {
  padding:14px 16px 12px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.app-title {
  font-size:1rem;
  font-weight:600;
  display:flex;
  align-items:center;
  gap:6px;
}

.app-logo {
  width:22px;
  height:22px;
  border-radius:9px;
  background:radial-gradient(circle at 30% 0,#60a5fa,#1d4ed8);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:.8rem;
}

/* Offline badge */
.badge-pill {
  font-size:.7rem;
  padding:2px 8px;
  border-radius:999px;
  border:1px solid var(--b-sub);
  background:rgba(15,23,42,.8);
  color:var(--t-muted);
  display:flex;
  align-items:center;
  gap:4px;
}
.badge-dot {
  width:6px;
  height:6px;
  border-radius:50%;
  background:#22c55e;
  box-shadow:0 0 0 3px rgba(34,197,94,.4);
}

/* ============================================================
   4. LOCK SCREEN (PAGE)
   ============================================================ */

.lock-screen {
  position:fixed;
  inset:0;
  background:radial-gradient(circle at top,#020617,#000);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:50;
}
.lock-card {
  width:90%;
  max-width:360px;
  background:rgba(15,23,42,.96);
  border:1px solid rgba(55,65,81,.9);
  border-radius:24px;
  padding:18px 18px 16px;
  text-align:center;
  box-shadow:0 18px 40px rgba(0,0,0,.9);
}
.lock-title { font-size:1rem; font-weight:600; margin-bottom:4px; }
.lock-sub   { font-size:.75rem;color:var(--t-soft);margin-bottom:12px; }

.pin-inputs {
  display:flex;
  justify-content:center;
  gap:8px;
  margin:10px 0 14px;
}
.pin-inputs input {
  width:34px;
  height:38px;
  border-radius:12px;
  text-align:center;
  background:#020617;
  color:var(--t-main);
  border:1px solid rgba(75,85,99,.9);
  font-size:1.1rem;
}

.lock-btns {
  display:flex;
  gap:8px;
  justify-content:center;
  flex-wrap:wrap;
}

.lock-note {
  font-size:.7rem;
  color:var(--t-soft);
  margin-top:6px;
}

/* ============================================================
   5. BACKUP BANNER (COMPONENT)
   ============================================================ */

.backup-banner {
  margin:0 12px 8px;
  padding:8px 10px;
  border-radius:12px;
  background:rgba(127,29,29,.15);
  border:1px solid rgba(248,113,113,.7);
  display:flex;
  justify-content:space-between;
  align-items:center;
  color:#fecaca;
  font-size:.75rem;
  gap:8px;
}
.backup-banner-actions {
  display:flex;
  align-items:center;
  gap:4px;
}

/* ============================================================
   6. MONTH HEADER (COMPONENT)
   ============================================================ */

.month-header {
  padding:8px 16px 12px;
  display:flex;
  flex-direction:column;
  gap:8px;
}

.segment-toggle {
  padding:2px;
  border-radius:999px;
  border:1px solid rgba(75,85,99,.7);
  background:radial-gradient(circle at top,#0b1120,#020617 60%);
  display:flex;
  justify-content:center;
  box-shadow:0 6px 18px rgba(15,23,42,.9);
}
.seg {
  flex:1;
  padding:6px 10px;
  border:none;
  background:transparent;
  color:var(--t-muted);
  font-size:.78rem;
  border-radius:999px;
  cursor:pointer;
}
.seg-active {
  background:rgba(15,23,42,1);
  color:#f9fafb;
  box-shadow:0 8px 20px rgba(37,99,235,.6);
}

.month-nav {
  margin-top:6px;
  display:flex;
  justify-content:center;
  align-items:center;
  gap:10px;
}
.month-chip {
  padding:8px 22px;
  min-width:160px;
  border-radius:999px;
  text-align:center;
  background:rgba(15,23,42,.9);
  border:1px solid rgba(148,163,184,.5);
}
.month-main { font-weight:600; font-size:.9rem; }
.month-sub  { font-size:.72rem; color:var(--t-soft); }

.month-btn {
  width:26px; height:26px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,.5);
  background:rgba(15,23,42,.95);
  color:var(--t-muted);
  cursor:pointer;
  font-size:14px;
}

/* ============================================================
   7. MAIN CONTENT WRAPPER
   ============================================================ */

.content {
  flex:1;
  padding:0 12px calc(16px + var(--nav-h) + var(--safe-b));
  overflow-y:auto;
  overscroll-behavior-y:contain;
  position:relative;
}

.tab-page { min-height:100%; display:none; }
.tab-active { display:block; }

/* ============================================================
   8. HOME PAGE
   ============================================================ */

/* --- Summary Card --- */
.sum-card {
  background:linear-gradient(135deg,#020617,#020617);
  padding:14px 16px;
  margin-bottom:14px;
  border-radius:22px;
  border:1px solid rgba(148,163,184,.55);
  box-shadow:0 18px 40px rgba(0,0,0,.8);
}
.sum-label { font-size:.8rem; color:var(--t-soft); margin-bottom:4px; }
.sum-amt   { font-size:1.35rem; font-weight:600; }
.sum-row {
  margin-top:8px;
  display:flex;
  justify-content:space-between;
  gap:10px;
}
.sum-pill {
  flex:1;
  padding:7px 9px;
  border-radius:16px;
  background:rgba(15,23,42,.96);
  border:1px solid rgba(55,65,81,.9);
  font-size:.76rem;
}
.sum-pill strong {
  display:block;
  font-size:.82rem;
  margin-bottom:1px;
}

/* --- Transaction List --- */
.day-group { margin-bottom:12px; }
.day-head {
  padding:3px 4px 4px 2px;
  font-size:.78rem;
  color:var(--t-muted);
  display:flex;
  justify-content:space-between;
}
.day-main { font-weight:500; color:#e5e7eb; }
.day-sub  { font-size:.72rem; color:var(--t-soft); }

.tx-card {
  padding:9px 10px;
  margin-bottom:6px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-radius:var(--r-md);
  background:rgba(15,23,42,.96);
  border:1px solid rgba(31,41,55,.95);
  cursor:pointer;
}
.tx-l {
  display:flex;
  align-items:center;
  gap:8px;
  min-width:0;
}
.tx-icon {
  width:30px;height:30px;
  border-radius:12px;
  background:radial-gradient(circle at 30% 0,#1f2937,#020617);
  display:flex;align-items:center;justify-content:center;
  font-size:.9rem;
}
.tx-main { display:flex; flex-direction:column; font-size:.8rem; min-width:0; }
.tx-title {
  font-weight:500;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.tx-note {
  font-size:.7rem;
  color:var(--t-soft);
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.tx-r {
  margin-left:8px;
  text-align:right;
  font-size:.78rem;
}

.empty {
  padding:26px 12px;
  text-align:center;
  font-size:.8rem;
  color:var(--t-soft);
}

/* ============================================================
   9. STATS PAGE
   ============================================================ */

.stats-grid {
  display:flex;
  flex-direction:column;
  gap:14px;
}

.stats-card {
  background:rgba(15,23,42,.96);
  border-radius:var(--r-lg);
  padding:11px 14px;
  border:1px solid rgba(55,65,81,.9);
  box-shadow:0 18px 40px rgba(0,0,0,.7);
}

.st-title { font-size:.85rem; font-weight:500; margin-bottom:2px; }
.st-sub   { font-size:.72rem; color:var(--t-soft); margin-bottom:4px; }

.st-row {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-top:3px;
  font-size:.8rem;
}
.st-lab { color:var(--t-muted); }
.divider {
  height:1px;
  background:rgba(31,41,55,.9);
  margin:6px 0;
}

.chart-wrap {
  position:relative;
  height:220px;
  margin-top:4px;
  display:flex;
  align-items:center;
  justify-content:center;
}
.chart-wrap canvas {
  max-width:220px;
  max-height:220px;
}

/* Category List */
.cat-list {
  margin-top:8px;
  display:flex;
  flex-direction:column;
  gap:6px;
}

.cat-item {
  padding:9px 10px;
  border-radius:14px;
  background:radial-gradient(circle at top,#020617,#020617);
  border:1px solid rgba(55,65,81,.9);
  box-shadow:0 10px 24px rgba(0,0,0,.65);
}

.cat-head {
  display:flex;
  justify-content:space-between;
  align-items:center;
  cursor:pointer;
  gap:8px;
}

.cat-l {
  display:flex;
  align-items:center;
  gap:8px;
}

.cat-ic {
  width:26px;height:26px;
  border-radius:11px;
  background:radial-gradient(circle at 30% 0,#1f2937,#020617);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:.8rem;
}

.cat-name { font-size:.8rem; font-weight:500; }
.cat-per  { font-size:.76rem; color:var(--t-muted); }

.cat-val {
  text-align:right;
  font-size:.78rem;
  display:flex;
  flex-direction:column;
  align-items:flex-end;
}
.cat-amt { font-weight:500; }

.cat-pct-pill {
  padding:2px 8px;
  font-size:.7rem;
  border-radius:999px;
  background:rgba(15,23,42,.9);
  border:1px solid rgba(75,85,99,.9);
  color:#e5e7eb;
}

.cat-toggle { font-size:.9rem; color:var(--t-soft); }

.sub-list {
  display:none;
  padding-top:4px;
  margin-top:6px;
  border-top:1px solid rgba(31,41,55,.9);
}
.sub-row {
  display:flex;
  justify-content:space-between;
  padding:3px 1px;
  font-size:.76rem;
}

/* ============================================================
   10. SETTINGS PAGE
   ============================================================ */

.settings-list {
  display:flex;
  flex-direction:column;
  gap:10px;
  margin-top:4px;
}

.set-card {
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
  padding:11px 14px;
  background:rgba(15,23,42,.96);
  border-radius:var(--r-lg);
  border:1px solid rgba(55,65,81,.9);
  font-size:.8rem;
}

.set-main {
  display:flex;
  flex-direction:column;
  gap:2px;
}
.set-title { font-weight:500; }
.set-sub   { font-size:.72rem; color:var(--t-soft); }

/* ============================================================
   11. CATEGORY MANAGER SHEET
   ============================================================ */

.cat-mgr-list {
  display:flex;
  flex-direction:column;
  gap:8px;
  margin-top:6px;
}

.cat-card {
  background:rgba(15,23,42,.98);
  border-radius:16px;
  padding:9px 10px;
  border:1px solid rgba(55,65,81,.9);
}

.cat-card-head {
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:8px;
}

.cat-card-left {
  display:flex;
  align-items:center;
  gap:8px;
}

.cat-card-main { display:flex; flex-direction:column; font-size:.78rem; }
.cat-card-name { font-weight:500; }
.cat-card-sub  { font-size:.7rem; color:var(--t-soft); }

.cat-card-btns { display:flex; gap:6px; }

/* --- Subcategory Editor Pills --- */

.subcat-list {
  display:flex;
  flex-wrap:wrap;
  gap:6px;
  margin-bottom:6px;
}
.subcat-pill {
  display:flex;
  align-items:center;
  gap:6px;
  padding:4px 10px;
  border-radius:999px;
  background:rgba(31,41,55,.9);
  border:1px solid rgba(75,85,99,.9);
  font-size:.72rem;
  color:#e5e7eb;
}
.subcat-del {
  border:none;
  background:transparent;
  color:#9ca3af;
  cursor:pointer;
}
.subcat-del:hover { color:#f97373; }

.subcat-add-row {
  display:flex;
  gap:6px;
  margin-top:4px;
}
.subcat-add-row input {
  flex:1;
}

/* ============================================================
   12. FAB (COMPONENT)
   ============================================================ */

.fab {
  position:fixed;
  right:24px;
  bottom:calc(var(--nav-h) + 28px + var(--safe-b));
  width:54px;
  height:54px;
  border:none;
  border-radius:999px;
  background:radial-gradient(circle at 30% 0,#60a5fa,#2563eb);
  color:#fff;
  font-size:1.6rem;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:0 18px 36px rgba(37,99,235,.9);
  cursor:pointer;
  z-index:15;
}

/* ============================================================
   13. SHEETS (ENTRY + CATEGORY)
   ============================================================ */

.sheet-bg {
  position:fixed;
  inset:0;
  display:none;
  align-items:flex-end;
  justify-content:center;
  background:rgba(0,0,0,.6);
  z-index:30;
}
.sheet-bg.active { display:flex; }

.sheet {
  width:100%;
  max-width:480px;
  background:rgba(15,23,42,.98);
  padding:10px 16px 12px;
  border-radius:20px 20px 0 0;
  border-top:1px solid rgba(75,85,99,.9);
  box-shadow:0 -16px 40px rgba(0,0,0,.9);
}

.sheet-handle {
  width:40px;height:4px;
  background:rgba(75,85,99,.9);
  border-radius:999px;
  margin:4px auto 8px;
}
.sheet-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:6px;
}
.sheet-title { font-size:.9rem; font-weight:500; }
.sheet-close {
  border:none;
  background:transparent;
  color:var(--t-soft);
  font-size:1.2rem;
  cursor:pointer;
}

/* Entry form */
.form-grid {
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:10px;
  margin:4px 0 6px;
}
.fg { display:flex; flex-direction:column; gap:3px; font-size:.75rem; }
.fg-full { grid-column:1 / -1; }

/* Inputs */
select,
input[type=number],
input[type=date],
input[type=text],
textarea {
  background:rgba(15,23,42,.98);
  border:1px solid rgba(55,65,81,.9);
  border-radius:12px;
  padding:6px 8px;
  color:var(--t-main);
  font-size:.8rem;
  outline:none;
}
select:focus,
input:focus,
textarea:focus {
  border-color:var(--acc);
  box-shadow:0 0 0 1px rgba(59,130,246,.6);
}
textarea {
  min-height:52px;
  max-height:100px;
  resize:vertical;
}

.sheet-foot {
  display:flex;
  justify-content:space-between;
  gap:8px;
  margin-top:4px;
}
.hint {
  font-size:.7rem;
  color:var(--t-soft);
  margin-top:4px;
}

/* ============================================================
   14. BOTTOM NAV (COMPONENT)
   ============================================================ */

.bottom-nav {
  position:fixed;
  left:0;right:0;bottom:0;
  padding:6px 14px calc(6px + var(--safe-b));
  background:radial-gradient(circle at top,#0b1120,#020617 55%,#000);
  border-top:1px solid rgba(15,23,42,.95);
  display:flex;
  justify-content:center;
  z-index:20;
}
.nav-inner {
  max-width:460px;
  width:100%;
  padding:4px 8px;
  display:flex;
  justify-content:space-around;
  background:rgba(15,23,42,.98);
  border-radius:999px;
  border:1px solid rgba(55,65,81,.9);
  box-shadow:0 18px 40px rgba(0,0,0,.85);
}

.nav-item {
  flex:1;
  padding:5px 0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  font-size:.7rem;
  color:var(--t-muted);
  gap:1px;
  cursor:pointer;
  border-radius:999px;
}
.nav-icon { font-size:1.05rem; }

.nav-active {
  background:rgba(15,23,42,1);
  color:var(--acc2);
  box-shadow:0 12px 24px rgba(37,99,235,.7);
}
.nav-active .nav-icon { transform:translateY(-1px); }

/* ============================================================
   15. RESPONSIVE
   ============================================================ */

@media(max-height:650px){
  .chart-wrap { height:220px; }
}
